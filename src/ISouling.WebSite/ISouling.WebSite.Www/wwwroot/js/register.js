function changePwdType(){var e=$("#password"),a=e.attr("type"),s="password"==a?"text":"password";e.attr("type",s)}function mobileKeyup(){mobileKeyupTask($("#mobile"),$("#mobileinfo"))}function mobileKeyup2(){mobileKeyupTask($("#mobile2"),$("#mobileinfo2"))}function mobileKeyupTask(e,a){var s=e.val();s=s.replace(/[^\d]/g,""),e.val(s),s.length>7?a.html(s.substring(0,3)+"&nbsp;"+s.substring(3,7)+"&nbsp;"+s.substring(7,s.length)+"<em></em>").show():s.length>3?a.html(s.substring(0,3)+"&nbsp;"+s.substring(3,s.length)+"<em></em>").show():s.length>0?a.html(s+"<em></em>").show():a.html("").hide(),e.on("focusout",function(){a.hide()}).on("focusin",function(){s.length>0&&a.show()})}function checkMobile(){return chkMobile=!1,checkMobileTask("mobile")}function checkMobile2(){return chkMobile2=!1,checkMobileTask("mobile2")}function checkMobileTask(e){var a=$("#"+e),s=$("p[for='"+e+"']"),t=$.trim(a.val());return s.html(""),11!=t.length?(a.addClass("Validform_error"),s.html('<span class="errortip">请填写正确的手机号</span>'),!1):mobileReg.test(t)?void $.ajax({type:"post",dataType:"html",url:basePath+"#",data:{account:t},success:function(e){if("1"!=e)return chkMobile=!0,chkMobile2=!0,s.html('<span class="successicon"></span>'),!0;a.addClass("Validform_error"),s.html('<span class="errortip">该手机号已存在，请输入其他手机号</span>')}}):(a.addClass("Validform_error"),s.html('<span class="errortip">请填写正确的手机号</span>'),!1)}function checkPassword(){chkPassword=!1;var e=$("input[name='password']"),a=$("p[for='password']"),s=$.trim(e.val());return a.html(""),isNullReg.test(s)?(e.addClass("Validform_error"),a.html('<span class="errortip">密码不能为空</span>'),!1):s.length<6||s.length>20?(e.addClass("Validform_error"),a.html('<span class="errortip">6~20个字符，区分大小写</span>'),!1):(chkPassword=!0,a.html('<span class="successicon"></span>'),!0)}function checkRePassword(){var e=$("input[name='password']"),a=$("input[name='repassword']"),s=$("p[for='repassword']"),t=$.trim(a.val());return s.html(""),checkPassword()?isNullReg.test(t)?(a.addClass("Validform_error"),s.html('<span class="errortip">确认密码不能为空</span>'),!1):e.val()==t||(a.addClass("Validform_error"),s.html('<span class="errortip">您两次输入的密码不一致</span>'),!1):(e.focus(),a.val(""),!1)}function checkRandCode(){chkRandCode=!1;var e=$("input[name='randcode']"),a=$("p[for='randcode']"),s=$.trim(e.val());return a.html(""),null==s||""==s?(e.addClass("Validform_error"),a.html('<span class="errortip">图形验证码不能为空</span>'),!1):verifyCodeReg.test(s)?(chkRandCode=!0,!0):(e.addClass("Validform_error"),a.html('<span class="errortip">请填写正确的验证码</span>'),!1)}function checkVerifyCode(){var e=$("#verifyCode"),a=e.val(),s=$(".input-tip[for=code]"),t=/^[0-9]{6}$/;return s.html(""),""==a?(e.addClass("Validform_error"),s.html('<span class="errortip">短信验证码不能为空</span>'),!1):!!t.test(a)||(e.addClass("Validform_error"),s.html('<span class="errortip">您输入6位有效验证码</span>'),!1)}function checkInviteCode(){chkRegCode=!1;var e=$("input[name='inviteCode']"),a=$("p[for='inviteCode']"),s=$.trim(e.val());return a.html(""),null==s||""==s?(chkRegCode=!0,!0):codeReg.test(s)||mobileReg.test(s)?void $.ajax({type:"post",dataType:"json",url:basePath+"#",data:{code:s},success:function(s){"1"==s?(e.addClass("Validform_error"),a.html('<span class="errortip">邀请码不存在，请核对或暂不填写邀请码。</span>')):chkRegCode=!0}}):(e.addClass("Validform_error"),a.html('<span class="errortip">您输入的邀请码格式不正确</span>'),!1)}function chkRegform(){return chkMobile?1!=graphicValidat||chkRandCode?chkRegCode?checkPassword():(checkInviteCode(),!1):(checkRandCode(),!1):(checkMobile(),!1)}function setCookie(e,a){var s=new Date;s.setTime(s.getTime()+864e5),document.cookie=e+"="+escape(a)+";expires="+s.toGMTString()}function getCookie(e){var a,s=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(a=document.cookie.match(s))?unescape(a[2]):null}function changeInvite(){$("#invitediv").is(":hidden")?($("#invitediv").slideDown(),$("#inviteDesc").html('<i class="iconfont">&#xe65a;</i>推荐人(选填)')):($("#invitediv").slideUp(),$("#inviteCode").val(""),$("p[for='inviteCode']").html(""),$("#inviteDesc").html('<i class="iconfont">&#xe659;</i>推荐人(选填)'))}function getISODate(e){var a=function(e,a){return(1e15+e+"").slice(-a)};return void 0===e&&(e=new Date),e.getFullYear()+a(e.getMonth()+1,2)+a(e.getDate(),2)}function sendVoiceCode(){if(!chkMobile2)return checkMobile2(),!1;if(chkMobile2){var e=$(".input-tip[for=code]");e.html("");var a=$("input[name='mobile']").val(),s=getISODate(new Date),t=getCookie(a+s+"_voice"),i=getCookie(a+s);if(t>=3&&i<3)return $("#getVerifyCode").removeClass("disabled").attr("disabled",!1).html("获取验证码"),$("#voicediv").html('收不到短信验证码？<span class="btn-voice disabled">语音获取</span>'),e.html('<span class="warningtip">获取次数超限，请尝试使用短信获取</span>'),void $("#voicetip").show();if(t>=3&&i>=3)return $("#voicediv").html('收不到短信验证码？<span class="btn-voice disabled">语音获取</span>'),$("#getVerifyCode").addClass("disabled").attr("disabled",!0),void e.html('<span class="warningtip">今天该手机号码已超过接收验证码上限，发送失败！</span>');$.ajax({type:"post",url:basePath+"#",data:{type:"2",phone:a,randCode:$("input[name=randcode]").val()},success:function(t){if(0==t.success)e.html('<span class="errortip">'+t.msg+"</span>");else if(1==t.success){var i=getCookie(a+s+"_voice");null==i||""==i?setCookie(a+s+"_voice",1):setCookie(a+s+"_voice",parseInt(i)+1),setCookie("clickTime",(new Date).getTime()),disableButtonByClockVoice(60)}else-2==t.success?($("input[name='randcode']").addClass("Validform_error"),$(".input-tip[for=randcode]").html('<span class="errortip">'+t.msg+"</span>"),$("#randImg").click()):(e.html('<span class="errortip">'+t.msg+"</span>"),$("#randImg").click())}})}}function disableButtonByClock(e){if(!voicetype){$("#getVerifyCode").addClass("disabled").attr("disabled",!0).html(e+"s重发"),$("#voicediv").html('收不到短信验证码？<a  class="btn-voice" onclick="sendVoiceCode()" href="javascript:;">语音获取</a>');var a=parseInt(e);0===a?$("#getVerifyCode").removeClass("disabled").attr("disabled",!1).html("获取验证码"):setTimeout("disableButtonByClock("+(a-1)+")",1e3)}}function disableButtonByClockVoice(e){voicetype=!0,$("#getVerifyCode").addClass("disabled").attr("disabled",!0).html(e+"s后重发"),$("#voicediv").html('<span class="c-orange">请您注意接听来电</span>');var a=parseInt(e);0==a?(voicetype=!1,$("#getVerifyCode").removeClass("disabled").attr("disabled",!1).html("获取验证码"),$("#voicediv").html('收不到短信验证码？<a  class="btn-voice" onclick="sendVoiceCode()" href="javascript:;">语音获取</a>')):setTimeout("disableButtonByClockVoice("+(a-1)+")",1e3)}function keyupPassword(){var e=$("#password").val(),a=AuthPasswd(e);1==a?$("#pwdlevel").show().find(".weak").addClass("on").html("弱").siblings().removeClass("on").html(""):2==a?($("#pwdlevel").show().find(".weak").addClass("on").html("").siblings().removeClass("on").html(""),$("#pwdlevel").find(".middle").addClass("on").html("中")):3==a?($("#pwdlevel").show().find("em").addClass("on").html(""),$("#pwdlevel").find(".strong").html("强")):$("#pwdlevel").hide()}function AuthPasswd(e){var a=0;return e.length>=6&&(/[a-zA-Z]+/.test(e)&&/[0-9]+/.test(e)&&/[^a-zA-Z0-9]+/.test(e)?a=3:(/[a-zA-Z]+/.test(e)||/[0-9]+/.test(e)||/[^a-zA-Z0-9]+/.test(e))&&(a=/[a-zA-Z]+/.test(e)&&/[0-9]+/.test(e)?2:/[a-zA-Z]+/.test(e)&&/[^a-zA-Z0-9]+/.test(e)?2:/[0-9]+/.test(e)&&/[^a-zA-Z0-9]+/.test(e)?2:1)),a}function regNext(){var e=$("#formtip");chkRegform()&&(console.log("跳到注册第二步"),$.ajax({type:"post",url:basePath+"#",data:{randCode:$("input[name=randcode]").val()},success:function(a){-1==a.success?e.html('<span class="errortip">'+a.msg+"</span>"):1==a.success?toNext():-2==a.success?($("input[name='randcode']").addClass("Validform_error"),$(".input-tip[for=randcode]").html('<span class="errortip">'+a.msg+"</span>"),$("#randImg").click()):(e.html('<span class="errortip">'+a.msg+"</span>"),$("#randImg").click())}}))}function toNext(){var e=$("#mobile").val(),a=$("#password").val(),s=$("#inviteCode").val();$("#mobile2").val(e),$("#mobiletxt").html(e),$("#password2").val(a),$("#inviteCode2").val(s),$("#accessform1").hide(),$("#accessform2").show(),$("#getVerifyCode").click(),chkMobile2=!0}function changeMoblie(){chkMobile2=!1,$("#mobilediv1").hide(),$("#mobilediv2").show()}function chkRegform2(){if(!chkMobile2)return checkMobile2(),!1}function onSubmit(){if(!chkMobile2)return checkMobile2(),!1;checkVerifyCode()&&($("#submit").addClass("disabled").attr("disabled",!0),$.ajax({url:basePath+"#",type:"POST",data:$("#form2").serialize(),dataType:"json",cache:!1,async:!0,success:function(e){var a=$.parseJSON(e);a.success?window.location=basePath+a.msg:($("#submit").removeClass("disabled").attr("disabled",!1),$("input[name='mobile']").val(a.data.phone),$("#verifyCode").val(""),$("#formtip2").html('<span class="errortip">'+a.data.msg+"</span>"))}}))}var chkMobile=!1,chkMobile2=!1,chkPassword=!1,chkRandCode=!1,chkRegCode=!0,mobileReg=/^(13|14|15|18|17)[0-9]{9}$/,isNullReg=/^[\s]{0,}$/,codeReg=/^[A-Za-z0-9]{3,10}$/,verifyCodeReg=/^[A-Za-z0-9]{5}$/,graphicValidat;$(function(){$("#getVerifyCode").removeClass("disabled").attr("disabled",!1);var e=$.trim($("input[name='mobile']").val());isNullReg.test(e)||checkMobile(),graphicValidat=$("#graphicValidat").val()}),$("input.icheck_flat").iCheck({checkboxClass:"u-checkbox-orange",radioClass:"u-iradio-orange"}),$('input[name="tjcheck"]').on("ifChecked",function(e){"2"==$(this).val()?$("#code").show():$("#code").val("").hide()}),$("#getVerifyCode").on("click",function(){if(!chkMobile2)return checkMobile2(),!1;if(chkMobile2){var e=$("input[name='verifyCode']"),a=$(".input-tip[for=code]");a.html("");var s=$("input[name='mobile']").val(),t=getISODate(new Date),i=getCookie(s+t+"_voice"),o=getCookie(s+t);if(o>=3&&i<3)return $("#getVerifyCode").addClass("disabled").attr("disabled",!0),$("#voicediv").html('收不到短信验证码？<a class="btn-voice" onclick="sendVoiceCode()" href="javascript:;">语音获取</a>'),a.html('<span class="warningtip">获取次数超限，请尝试使用语音获取</span>'),void $("#voicetip").show();if(i>=3&&o>=3)return $("#getVerifyCode").addClass("disabled").attr("disabled",!0),$("#voicediv").html('收不到短信验证码？<span class="btn-voice disabled">语音获取</span>'),void a.html('<span class="warningtip">今天该手机号码已超过接收验证码上限，发送失败！</span>');$.ajax({type:"post",url:basePath+"#",data:{type:"1",phone:s,randCode:$("input[name=randcode]").val()},success:function(i){if(0==i.success)e.addClass("Validform_error"),a.html('<span class="errortip">'+i.msg+"</span>");else if(1==i.success){var o=getCookie(s+t);null==o||""==o?setCookie(s+t,1):setCookie(s+t,parseInt(o)+1),setCookie("clickTime",(new Date).getTime()),disableButtonByClock(60)}else-2==i.success?($("input[name='randcode']").addClass("Validform_error"),$(".input-tip[for=randcode]").html('<span class="errortip">'+i.msg+"</span>"),$("#randImg").click()):(e.addClass("Validform_error"),a.html('<span class="errortip">'+i.msg+"</span>"),$("#randImg").click())}})}});var voicetype=!1;